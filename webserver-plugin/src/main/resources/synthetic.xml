<?xml version="1.0" encoding="UTF-8"?>
<synthetic xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns="http://www.xebialabs.com/deployit/synthetic"
           xsi:schemaLocation="http://www.xebialabs.com/deployit/synthetic synthetic.xsd">

    <type-modification type="www.PublishedWebContent">
        <!-- overridden at runtime for virtual hosts -->
        <property name="targetDirectory" default="${deployed.container.htdocsDirectory}" />
        <!-- not applicable for this type -->
        <property name="targetFile" required="false" hidden="true" />
    </type-modification>
    
    <!-- workaround for http://tech.xebialabs.com/jira/browse/DEPLOYITPB-2236 -->
    <type type="www.PublishedWebContent2" extends="www.PublishedWebContent"
        deployable-type="www.WebContent" container-type="www.ApacheHttpdServer" />
    
    <type type="www.WebContent" extends="generic.Folder" />

    <type-modification type="www.ApacheConfFragment">
        <!-- user configuration options -->
        <property name="targetFile" default="${deployed.name}.conf" />
        
        <!-- admin configuration options -->
        <property name="targetDirectory" hidden="true" default="${deployed.container.confDirectory}" />
        <property name="template" hidden="true" default="www/apache/${deployed.type}.conf.ftl" />
    </type-modification>
    
    <!-- prevents non-www generic.Resource types from being deployed to a web server --> 
    <type type="www.ApacheConfFragmentSpec" extends="generic.Resource" />
    
    <type-modification type="www.ApacheVirtualHost">
        <!-- user configuration options -->
        <property name="host" description="The virtual host name. Use '*' to match all hosts" />
        <property name="port" description="The virtual host port. Use '*' to match all ports" />
        <property name="documentRoot" required="false" description="The document root for web content using this virtual host. If left blank, a directory is created in the web server's document root" />
    </type-modification>
    
    <!-- workaround for http://tech.xebialabs.com/jira/browse/DEPLOYITPB-2236 -->
    <type type="www.ApacheVirtualHost2" extends="www.ApacheVirtualHost"
        deployable-type="www.ApacheVirtualHostSpec" container-type="www.ApacheHttpdServer">
      <generate-deployable type="www.ApacheVirtualHostSpec" extends="www.ApacheConfFragmentSpec" />
    </type>

    <type type="www.ApacheHttpdServer" extends="generic.Container"
          description="An Apache HTTPD web server">
        <!-- unhide any of the following and edit per instance if there is substantial variation across your install base; 
          sub-types with overridden values are preferred if there is a manageable number -->
        <property name="startScript" hidden="true" default="/usr/sbin/apachectl start" description="The command to start Apache. Arguments containing spaces are not supported" />
        <property name="stopScript" hidden="true" default="/usr/sbin/apachectl stop" description="The command to stop Apache. Arguments containing spaces are not supported" />
        <property name="restartScript" hidden="true" required="false" default="/usr/sbin/apachectl restart" description="The command to restart Apache. If left blank, the sequence 'stop, start' is used. Arguments containing spaces are not supported" />
        <property name="reloadScript" hidden="true" required="false" default="/usr/sbin/apachectl reload" description="The command to reload the Apache configuration without restarting the server. Arguments containing spaces are not supported" />
        <property name="htdocsDirectory" hidden="true" default="/var/httpd/www" 
          description="The directory in which document roots for virtual hosts should be created. Web content deployed without a virtual host will also be copied into this directory"/>
        <property name="confDirectory" hidden="true" default="/var/httpd/conf"
          description="The directory into which Apache configuration files (for virtual host definitions) should be written"/>
    </type>
</synthetic>
